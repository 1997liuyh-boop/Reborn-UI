{
  "name": "multi-step-loader",
  "dependencies": [],
  "files": [
    {
      "path": "index.ts",
      "content": "export { default as MultiStepLoader } from \"./MultiStepLoader.vue\";\r\n"
    },
    {
      "path": "MultiStepLoader.vue",
      "content": "<template>\r\n  <Transition\r\n    enter-active-class=\"transition-opacity duration-300\"\r\n    enter-from-class=\"opacity-0\"\r\n    enter-to-class=\"opacity-100\"\r\n    leave-active-class=\"transition-opacity duration-300\"\r\n    leave-from-class=\"opacity-100\"\r\n    leave-to-class=\"opacity-0\"\r\n  >\r\n    <div\r\n      v-if=\"loading && steps.length > 0\"\r\n      class=\"fixed inset-0 z-[100] flex size-full items-center justify-center backdrop-blur-2xl\"\r\n    >\r\n      <!-- Closing Button -->\r\n      <button\r\n        v-show=\"!preventClose\"\r\n        class=\"absolute right-4 top-4 z-[101] inline-flex h-9 items-center justify-center whitespace-nowrap rounded-md bg-primary px-3 text-sm font-medium text-primary-foreground ring-offset-background transition-colors hover:bg-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\"\r\n        size=\"sm\"\r\n        @click=\"close\"\r\n      >\r\n        <!-- x-mark-heroicons -->\r\n        <svg\r\n          xmlns=\"http://www.w3.org/2000/svg\"\r\n          fill=\"none\"\r\n          viewBox=\"0 0 24 24\"\r\n          stroke-width=\"1.5\"\r\n          stroke=\"currentColor\"\r\n          class=\"size-6\"\r\n        >\r\n          <path\r\n            stroke-linecap=\"round\"\r\n            stroke-linejoin=\"round\"\r\n            d=\"M6 18 18 6M6 6l12 12\"\r\n          />\r\n        </svg>\r\n      </button>\r\n      <div class=\"relative h-96\">\r\n        <div class=\"relative mx-auto mt-40 flex max-w-xl flex-col justify-start\">\r\n          <div\r\n            v-for=\"(step, index) in steps\"\r\n            :key=\"index\"\r\n          >\r\n            <div\r\n              v-if=\"step\"\r\n              class=\"mb-4 flex items-center gap-2 text-left transition-all duration-300 ease-in-out\"\r\n              :style=\"{\r\n                opacity:\r\n                  index === currentState\r\n                    ? 1\r\n                    : Math.max(1 - Math.abs(index - currentState) * 0.2, 0),\r\n                transform: `translateY(${\r\n                  index === currentState ? -(currentState * 40) : -(currentState * 40)\r\n                }px)`,\r\n              }\"\r\n            >\r\n              <!--  check-circle-solid-heroicons -->\r\n              <svg\r\n                v-if=\"\r\n                  index < currentState ||\r\n                  (index === steps.length - 1 && index === currentState && isLastStepComplete)\r\n                \"\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                viewBox=\"0 0 24 24\"\r\n                fill=\"currentColor\"\r\n                class=\"size-6 text-primary\"\r\n              >\r\n                <path\r\n                  fill-rule=\"evenodd\"\r\n                  d=\"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z\"\r\n                  clip-rule=\"evenodd\"\r\n                />\r\n              </svg>\r\n              <!-- arrow-path-heroicons -->\r\n              <svg\r\n                v-else-if=\"\r\n                  index === currentState && (!isLastStepComplete || index !== steps.length - 1)\r\n                \"\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                viewBox=\"0 0 24 24\"\r\n                fill=\"currentColor\"\r\n                class=\"size-6 animate-spin text-primary\"\r\n              >\r\n                <path\r\n                  fill-rule=\"evenodd\"\r\n                  d=\"M4.755 10.059a7.5 7.5 0 0 1 12.548-3.364l1.903 1.903h-3.183a.75.75 0 1 0 0 1.5h4.992a.75.75 0 0 0 .75-.75V4.356a.75.75 0 0 0-1.5 0v3.18l-1.9-1.9A9 9 0 0 0 3.306 9.67a.75.75 0 1 0 1.45.388Zm15.408 3.352a.75.75 0 0 0-.919.53 7.5 7.5 0 0 1-12.548 3.364l-1.902-1.903h3.183a.75.75 0 0 0 0-1.5H2.984a.75.75 0 0 0-.75.75v4.992a.75.75 0 0 0 1.5 0v-3.18l1.9 1.9a9 9 0 0 0 15.059-4.035.75.75 0 0 0-.53-.918Z\"\r\n                  clip-rule=\"evenodd\"\r\n                />\r\n              </svg>\r\n              <!-- check-circle-outline-heroicons -->\r\n              <svg\r\n                v-else\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                fill=\"none\"\r\n                viewBox=\"0 0 24 24\"\r\n                stroke-width=\"1.5\"\r\n                stroke=\"currentColor\"\r\n                class=\"size-6 text-black opacity-50 dark:text-white\"\r\n              >\r\n                <path\r\n                  stroke-linecap=\"round\"\r\n                  stroke-linejoin=\"round\"\r\n                  d=\"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z\"\r\n                />\r\n              </svg>\r\n              <div class=\"flex flex-col\">\r\n                <span\r\n                  :class=\"[\r\n                    'text-lg text-black dark:text-white',\r\n                    index > currentState && 'opacity-50',\r\n                  ]\"\r\n                >\r\n                  {{ step.text }}\r\n                </span>\r\n                <Transition\r\n                  enter-active-class=\"transition-all duration-300\"\r\n                  enter-from-class=\"opacity-0 -translate-y-1\"\r\n                  enter-to-class=\"opacity-100 translate-y-0\"\r\n                >\r\n                  <span\r\n                    v-if=\"\r\n                      step.afterText &&\r\n                      (index < currentState ||\r\n                        (index === steps.length - 1 &&\r\n                          index === currentState &&\r\n                          isLastStepComplete))\r\n                    \"\r\n                    class=\"mt-1 text-sm text-gray-500 dark:text-gray-400\"\r\n                  >\r\n                    {{ step.afterText }}\r\n                  </span>\r\n                </Transition>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div\r\n        class=\"absolute inset-x-0 bottom-0 z-[-1] h-full bg-white bg-gradient-to-t [mask-image:radial-gradient(900px_at_center,white_30%,transparent)] dark:bg-black\"\r\n      ></div>\r\n    </div>\r\n  </Transition>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, watch, onUnmounted } from \"vue\";\r\n\r\ninterface Step {\r\n  text: string; // Display text for the step\r\n  afterText?: string; // Text to show after step completion\r\n  async?: boolean; // If true, waits for external trigger to proceed\r\n  duration?: number; // Duration in ms before proceeding (default: 2000)\r\n  action?: () => void; // Function to execute when step is active\r\n}\r\ninterface Props {\r\n  steps: Step[];\r\n  loading?: boolean;\r\n  defaultDuration?: number;\r\n  preventClose?: boolean;\r\n}\r\nconst props = withDefaults(defineProps<Props>(), {\r\n  loading: false,\r\n  defaultDuration: 1500,\r\n  preventClose: false,\r\n});\r\n\r\nconst emit = defineEmits<{\r\n  \"state-change\": [number];\r\n  complete: [];\r\n  close: [];\r\n}>();\r\n\r\nconst currentState = ref(0);\r\nconst stepStartTime = ref(Date.now());\r\nconst isLastStepComplete = ref(false);\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nlet currentTimer: any = null;\r\n\r\nasync function executeStepAction(step: Step) {\r\n  if (typeof step.action === \"function\") {\r\n    await step.action();\r\n  }\r\n}\r\n\r\nasync function proceedToNextStep() {\r\n  const currentStep = props.steps[currentState.value];\r\n  if (!currentStep) return;\r\n\r\n  // Execute the current step's action\r\n  await executeStepAction(currentStep);\r\n\r\n  if (currentState.value < props.steps.length - 1) {\r\n    currentState.value++;\r\n    stepStartTime.value = Date.now();\r\n    emit(\"state-change\", currentState.value);\r\n    processCurrentStep();\r\n  } else {\r\n    isLastStepComplete.value = true;\r\n    emit(\"complete\");\r\n  }\r\n}\r\n\r\nasync function processCurrentStep() {\r\n  if (currentTimer) {\r\n    clearTimeout(currentTimer);\r\n  }\r\n\r\n  const currentStep = props.steps[currentState.value];\r\n  if (!currentStep) return;\r\n\r\n  const duration = currentStep.duration || props.defaultDuration;\r\n\r\n  if (!currentStep.async) {\r\n    currentTimer = setTimeout(() => {\r\n      proceedToNextStep();\r\n    }, duration);\r\n  }\r\n}\r\n\r\nfunction close() {\r\n  emit(\"close\");\r\n}\r\n\r\n// Watch for changes in the async property\r\nwatch(\r\n  () => props.steps[currentState.value]?.async,\r\n  async (isAsync, oldIsAsync) => {\r\n    // Only proceed if changing from async to non-async\r\n    if (isAsync === false && oldIsAsync === true) {\r\n      const currentStep = props.steps[currentState.value];\r\n      if (!currentStep) return;\r\n\r\n      const duration = currentStep.duration || props.defaultDuration;\r\n      currentTimer = setTimeout(() => {\r\n        proceedToNextStep();\r\n      }, duration);\r\n    }\r\n  },\r\n);\r\n\r\nwatch(\r\n  () => props.loading,\r\n  (newLoading) => {\r\n    if (newLoading) {\r\n      currentState.value = 0;\r\n      stepStartTime.value = Date.now();\r\n      isLastStepComplete.value = false;\r\n      processCurrentStep();\r\n    } else if (currentTimer) {\r\n      clearTimeout(currentTimer);\r\n    }\r\n  },\r\n);\r\n\r\nonUnmounted(() => {\r\n  if (currentTimer) {\r\n    clearTimeout(currentTimer);\r\n  }\r\n});\r\n</script>\r\n"
    }
  ],
  "fileCount": 2,
  "contentHash": "d7d4cf72d24749df7f176f6acd0fe152f4ed3800"
}
