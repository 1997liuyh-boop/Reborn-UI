{
  "name": "link-preview",
  "dependencies": [],
  "files": [
    {
      "path": "index.ts",
      "content": "export { default as LinkPreview } from \"./LinkPreview.vue\";\r\n"
    },
    {
      "path": "LinkPreview.vue",
      "content": "<template>\r\n  <div :class=\"cn('relative inline-block', props.class)\">\r\n    <!-- Trigger -->\r\n    <NuxtLink\r\n      :to=\"url\"\r\n      :class=\"cn('text-black dark:text-white', props.linkClass)\"\r\n      @mousemove=\"handleMouseMove\"\r\n      @mouseenter=\"showPreview\"\r\n      @mouseleave=\"hidePreview\"\r\n    >\r\n      <slot />\r\n    </NuxtLink>\r\n\r\n    <!-- Preview -->\r\n    <div\r\n      v-if=\"isVisible\"\r\n      ref=\"preview\"\r\n      class=\"pointer-events-none absolute z-50\"\r\n      :style=\"previewStyle\"\r\n    >\r\n      <div\r\n        class=\"overflow-hidden rounded-xl shadow-xl\"\r\n        :class=\"[popClass, { 'transform-gpu': !props.isStatic }]\"\r\n      >\r\n        <div\r\n          class=\"block rounded-xl border-2 border-transparent bg-white p-1 shadow-lg dark:bg-gray-900\"\r\n        >\r\n          <img\r\n            :src=\"previewSrc\"\r\n            :width=\"width\"\r\n            :height=\"height\"\r\n            class=\"size-full rounded-lg object-cover\"\r\n            :style=\"imageStyle\"\r\n            alt=\"preview\"\r\n            @load=\"handleImageLoad\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, reactive, type CSSProperties } from \"vue\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ninterface BaseProps {\r\n  class?: string;\r\n  linkClass?: string;\r\n  width?: number;\r\n  height?: number;\r\n}\r\n\r\n// Props for static image mode\r\ninterface StaticImageProps extends BaseProps {\r\n  isStatic?: true;\r\n  imageSrc?: string;\r\n  url?: string; // optional in static mode\r\n}\r\n\r\n// Props for URL preview mode\r\ninterface URLPreviewProps extends BaseProps {\r\n  isStatic?: false; // optional but must be false if specified\r\n  imageSrc?: string; // optional in URL mode\r\n  url?: string;\r\n}\r\n\r\n// Combined type that enforces the requirements\r\ntype Props = StaticImageProps | URLPreviewProps;\r\nconst props = withDefaults(defineProps<Props>(), {\r\n  isStatic: false,\r\n  imageSrc: \"\",\r\n  url: \"\",\r\n  width: 200,\r\n  height: 125,\r\n});\r\n\r\nconst isVisible = ref(false);\r\nconst isLoading = ref(true);\r\nconst preview = ref<HTMLElement | null>(null);\r\nconst hasPopped = ref(false);\r\n\r\n// Generate preview URL\r\nconst previewSrc = computed(() => {\r\n  if (props.isStatic) return props.imageSrc;\r\n\r\n  const params = new URLSearchParams({\r\n    url: props.url,\r\n    screenshot: \"true\",\r\n    meta: \"false\",\r\n    embed: \"screenshot.url\",\r\n    colorScheme: \"light\",\r\n    \"viewport.isMobile\": \"true\",\r\n    \"viewport.deviceScaleFactor\": \"1\",\r\n    \"viewport.width\": String(props.width * 3),\r\n    \"viewport.height\": String(props.height * 3),\r\n  });\r\n\r\n  return `https://api.microlink.io/?${params.toString()}`;\r\n});\r\n\r\n// Position tracking\r\nconst mousePosition = reactive({\r\n  x: 0,\r\n  y: 0,\r\n});\r\n\r\n// Calculate preview position\r\nconst previewStyle = computed<CSSProperties>(() => {\r\n  if (!preview.value) return {};\r\n\r\n  const offset = 20;\r\n  const previewWidth = props.width;\r\n  const previewHeight = props.height;\r\n  const viewportWidth = window.innerWidth;\r\n\r\n  let x = mousePosition.x - previewWidth / 2;\r\n  x = Math.min(Math.max(0, x), viewportWidth - previewWidth);\r\n\r\n  const linkRect = preview.value.parentElement?.getBoundingClientRect();\r\n  const y = linkRect ? linkRect.top - previewHeight - offset : 0;\r\n\r\n  return {\r\n    position: \"fixed\",\r\n    left: `${x}px`,\r\n    top: `${y}px`,\r\n    width: `${previewWidth}px`,\r\n    height: `${previewHeight}px`,\r\n  };\r\n});\r\n\r\n// Image specific styling\r\nconst imageStyle = computed<CSSProperties>(() => ({\r\n  width: `${props.width}px`,\r\n  height: `${props.height}px`,\r\n}));\r\n\r\n// Pop animation class\r\nconst popClass = computed(() => {\r\n  if (!hasPopped.value) return \"\";\r\n  return \"animate-pop\";\r\n});\r\n\r\nfunction handleMouseMove(event: MouseEvent) {\r\n  mousePosition.x = event.clientX;\r\n  mousePosition.y = event.clientY;\r\n}\r\n\r\nfunction showPreview() {\r\n  isVisible.value = true;\r\n  setTimeout(() => {\r\n    hasPopped.value = true;\r\n  }, 50);\r\n}\r\n\r\nfunction hidePreview() {\r\n  isVisible.value = false;\r\n  hasPopped.value = false;\r\n}\r\n\r\nfunction handleImageLoad() {\r\n  isLoading.value = false;\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.transform-gpu {\r\n  transform: scale3d(0, 0, 1);\r\n  transform-origin: center bottom;\r\n  will-change: transform;\r\n  backface-visibility: hidden;\r\n}\r\n\r\n.animate-pop {\r\n  animation: pop 1000ms ease forwards;\r\n  will-change: transform;\r\n}\r\n\r\n@keyframes pop {\r\n  0% {\r\n    transform: scale3d(0.26, 0.26, 1);\r\n  }\r\n  25% {\r\n    transform: scale3d(1.1, 1.1, 1);\r\n  }\r\n  65% {\r\n    transform: scale3d(0.98, 0.98, 1);\r\n  }\r\n  100% {\r\n    transform: scale3d(1, 1, 1);\r\n  }\r\n}\r\n</style>\r\n",
      "target": "web"
    },
    {
      "path": "LinkPreview.vue",
      "content": "<template>\r\n  <view :class=\"cn('relative inline-block', props.class)\">\r\n    <!-- Trigger -->\r\n    <NuxtLink\r\n      :to=\"url\"\r\n      :class=\"cn('text-black dark:text-white', props.linkClass)\"\r\n      @mousemove=\"handleMouseMove\"\r\n      @mouseenter=\"showPreview\"\r\n      @mouseleave=\"hidePreview\"\r\n    >\r\n      <slot />\r\n    </NuxtLink>\r\n\r\n    <!-- Preview -->\r\n    <view\r\n      v-if=\"isVisible\"\r\n      ref=\"preview\"\r\n      class=\"pointer-events-none absolute z-50\"\r\n      :style=\"previewStyle\"\r\n    >\r\n      <view\r\n        class=\"overflow-hidden rounded-xl shadow-xl\"\r\n        :class=\"[popClass, { 'transform-gpu': !props.isStatic }]\"\r\n      >\r\n        <view\r\n          class=\"block rounded-xl border-2 border-transparent bg-white p-1 shadow-lg dark:bg-gray-900\"\r\n        >\r\n          <image\r\n            :src=\"previewSrc\"\r\n            :width=\"width\"\r\n            :height=\"height\"\r\n            class=\"size-full rounded-lg object-cover\"\r\n            :style=\"imageStyle\"\r\n            alt=\"preview\"\r\n            @load=\"handleImageLoad\"\r\n          />\r\n        </view>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, reactive, type CSSProperties } from \"vue\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ninterface BaseProps {\r\n  class?: string;\r\n  linkClass?: string;\r\n  width?: number;\r\n  height?: number;\r\n}\r\n\r\n// Props for static image mode\r\ninterface StaticImageProps extends BaseProps {\r\n  isStatic?: true;\r\n  imageSrc?: string;\r\n  url?: string; // optional in static mode\r\n}\r\n\r\n// Props for URL preview mode\r\ninterface URLPreviewProps extends BaseProps {\r\n  isStatic?: false; // optional but must be false if specified\r\n  imageSrc?: string; // optional in URL mode\r\n  url?: string;\r\n}\r\n\r\n// Combined type that enforces the requirements\r\ntype Props = StaticImageProps | URLPreviewProps;\r\nconst props = withDefaults(defineProps<Props>(), {\r\n  isStatic: false,\r\n  imageSrc: \"\",\r\n  url: \"\",\r\n  width: 200,\r\n  height: 125,\r\n});\r\n\r\nconst isVisible = ref(false);\r\nconst isLoading = ref(true);\r\nconst preview = ref<HTMLElement | null>(null);\r\nconst hasPopped = ref(false);\r\n\r\n// Generate preview URL\r\nconst previewSrc = computed(() => {\r\n  if (props.isStatic) return props.imageSrc;\r\n\r\n  const params = new URLSearchParams({\r\n    url: props.url,\r\n    screenshot: \"true\",\r\n    meta: \"false\",\r\n    embed: \"screenshot.url\",\r\n    colorScheme: \"light\",\r\n    \"viewport.isMobile\": \"true\",\r\n    \"viewport.deviceScaleFactor\": \"1\",\r\n    \"viewport.width\": String(props.width * 3),\r\n    \"viewport.height\": String(props.height * 3),\r\n  });\r\n\r\n  return `https://api.microlink.io/?${params.toString()}`;\r\n});\r\n\r\n// Position tracking\r\nconst mousePosition = reactive({\r\n  x: 0,\r\n  y: 0,\r\n});\r\n\r\n// Calculate preview position\r\nconst previewStyle = computed<CSSProperties>(() => {\r\n  if (!preview.value) return {};\r\n\r\n  const offset = 20;\r\n  const previewWidth = props.width;\r\n  const previewHeight = props.height;\r\n  const viewportWidth = window.innerWidth;\r\n\r\n  let x = mousePosition.x - previewWidth / 2;\r\n  x = Math.min(Math.max(0, x), viewportWidth - previewWidth);\r\n\r\n  const linkRect = preview.value.parentElement?.getBoundingClientRect();\r\n  const y = linkRect ? linkRect.top - previewHeight - offset : 0;\r\n\r\n  return {\r\n    position: \"fixed\",\r\n    left: `${x}px`,\r\n    top: `${y}px`,\r\n    width: `${previewWidth}px`,\r\n    height: `${previewHeight}px`,\r\n  };\r\n});\r\n\r\n// Image specific styling\r\nconst imageStyle = computed<CSSProperties>(() => ({\r\n  width: `${props.width}px`,\r\n  height: `${props.height}px`,\r\n}));\r\n\r\n// Pop animation class\r\nconst popClass = computed(() => {\r\n  if (!hasPopped.value) return \"\";\r\n  return \"animate-pop\";\r\n});\r\n\r\nfunction handleMouseMove(event: MouseEvent) {\r\n  mousePosition.x = event.clientX;\r\n  mousePosition.y = event.clientY;\r\n}\r\n\r\nfunction showPreview() {\r\n  isVisible.value = true;\r\n  setTimeout(() => {\r\n    hasPopped.value = true;\r\n  }, 50);\r\n}\r\n\r\nfunction hidePreview() {\r\n  isVisible.value = false;\r\n  hasPopped.value = false;\r\n}\r\n\r\nfunction handleImageLoad() {\r\n  isLoading.value = false;\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.transform-gpu {\r\n  transform: scale3d(0, 0, 1);\r\n  transform-origin: center bottom;\r\n  will-change: transform;\r\n  backface-visibility: hidden;\r\n}\r\n\r\n.animate-pop {\r\n  animation: pop 1000ms ease forwards;\r\n  will-change: transform;\r\n}\r\n\r\n@keyframes pop {\r\n  0% {\r\n    transform: scale3d(0.26, 0.26, 1);\r\n  }\r\n  25% {\r\n    transform: scale3d(1.1, 1.1, 1);\r\n  }\r\n  65% {\r\n    transform: scale3d(0.98, 0.98, 1);\r\n  }\r\n  100% {\r\n    transform: scale3d(1, 1, 1);\r\n  }\r\n}\r\n</style>\r\n",
      "target": "uniapp"
    }
  ],
  "fileCount": 3,
  "contentHash": "fd39c1a6361011d116fee9f23ff4983de52fe567"
}
