{
  "name": "tracing-beam",
  "dependencies": [
    "motion-v",
    "vue-use-spring"
  ],
  "files": [
    {
      "path": "index.ts",
      "content": "export { default as TracingBeam } from \"./TracingBeam.vue\";\r\n"
    },
    {
      "path": "TracingBeam.vue",
      "content": "<template>\r\n  <div\r\n    ref=\"tracingBeamRef\"\r\n    :class=\"cn('relative w-full max-w-4xl mx-auto h-full', $props.class)\"\r\n  >\r\n    <div class=\"absolute -left-4 top-3 md:-left-12\">\r\n      <div\r\n        :style=\"{\r\n          boxShadow: scrollYProgress > 0 ? 'none' : 'rgba(0, 0, 0, 0.24) 0px 3px 8px',\r\n        }\"\r\n        class=\"border-netural-200 ml-[27px] flex size-4 items-center justify-center rounded-full border shadow-sm\"\r\n      >\r\n        <Motion\r\n          :animate=\"{\r\n            backgroundColor: scrollYProgress > 0 ? 'white' : 'var(--emerald-500)',\r\n            borderColor: scrollYProgress > 0 ? 'white' : 'var(--emerald-600)',\r\n          }\"\r\n          class=\"size-2 rounded-full border border-neutral-300 bg-white\"\r\n        />\r\n      </div>\r\n      <svg\r\n        :viewBox=\"`0 0 20 ${svgHeight}`\"\r\n        width=\"20\"\r\n        :height=\"svgHeight\"\r\n        class=\"ml-4 block\"\r\n        aria-hidden=\"true\"\r\n      >\r\n        <path\r\n          :d=\"`M 1 0V -36 l 18 24 V ${svgHeight * 0.8} l -18 24V ${svgHeight}`\"\r\n          fill=\"none\"\r\n          stroke=\"#9091A0\"\r\n          stroke-opacity=\"0.16\"\r\n        ></path>\r\n        <path\r\n          :d=\"`M 1 0V -36 l 18 24 V ${svgHeight * 0.8} l -18 24V ${svgHeight}`\"\r\n          fill=\"none\"\r\n          stroke=\"url(#gradient)\"\r\n          stroke-width=\"1.25\"\r\n          class=\"motion-reduce:hidden\"\r\n        ></path>\r\n        <defs>\r\n          <linearGradient\r\n            id=\"gradient\"\r\n            gradientUnits=\"userSpaceOnUse\"\r\n            x1=\"0\"\r\n            x2=\"0\"\r\n            :y1=\"spring.y1\"\r\n            :y2=\"spring.y2\"\r\n          >\r\n            <stop\r\n              stop-color=\"#18CCFC\"\r\n              stop-opacity=\"0\"\r\n            ></stop>\r\n            <stop stop-color=\"#18CCFC\"></stop>\r\n            <stop\r\n              offset=\"0.325\"\r\n              stop-color=\"#6344F5\"\r\n            ></stop>\r\n            <stop\r\n              offset=\"1\"\r\n              stop-color=\"#AE48FF\"\r\n              stop-opacity=\"0\"\r\n            ></stop>\r\n          </linearGradient>\r\n        </defs>\r\n      </svg>\r\n    </div>\r\n    <div ref=\"tracingBeamContentRef\">\r\n      <slot />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport { Motion } from \"motion-v\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { useSpring } from \"vue-use-spring\";\r\nimport { ref, computed, onMounted, onUnmounted, watch } from \"vue\";\r\n\r\ndefineProps({\r\n  class: String,\r\n});\r\n\r\nconst tracingBeamRef = ref<HTMLDivElement>();\r\nconst tracingBeamContentRef = ref<HTMLDivElement>();\r\n\r\nconst scrollYProgress = ref(0);\r\nconst svgHeight = ref(0);\r\nconst scrollPercentage = ref(0);\r\n\r\nconst computedY1 = computed(\r\n  () =>\r\n    mapRange(scrollYProgress.value, 0, 0.8, scrollYProgress.value, svgHeight.value) *\r\n    (1.4 - scrollPercentage.value),\r\n);\r\n\r\nconst computedY2 = computed(\r\n  () =>\r\n    mapRange(scrollYProgress.value, 0, 1, scrollYProgress.value, svgHeight.value - 500) *\r\n    (1.4 - scrollPercentage.value),\r\n);\r\n\r\nconst spring = useSpring(\r\n  { y1: computedY1.value, y2: computedY2.value },\r\n  { tension: 80, friction: 26, precision: 0.01 },\r\n);\r\n\r\nwatch(computedY1, (newY1) => {\r\n  spring.y1 = newY1;\r\n});\r\n\r\nwatch(computedY2, (newY2) => {\r\n  spring.y2 = newY2;\r\n});\r\n\r\nfunction updateScrollYProgress() {\r\n  if (tracingBeamRef.value) {\r\n    const boundingRect = tracingBeamRef.value.getBoundingClientRect();\r\n    const windowHeight = window.innerHeight;\r\n    const elementHeight = boundingRect.height;\r\n\r\n    scrollPercentage.value = (windowHeight - boundingRect.top) / (windowHeight + elementHeight);\r\n\r\n    scrollYProgress.value = (boundingRect.y / windowHeight) * -1;\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  window.addEventListener(\"scroll\", updateScrollYProgress);\r\n  window.addEventListener(\"resize\", updateScrollYProgress);\r\n  updateScrollYProgress();\r\n\r\n  const resizeObserver = new ResizeObserver(function () {\r\n    updateSVGHeight();\r\n  });\r\n\r\n  resizeObserver.observe(tracingBeamContentRef.value!);\r\n\r\n  updateSVGHeight();\r\n});\r\n\r\nonUnmounted(() => {\r\n  tracingBeamRef.value?.removeEventListener(\"scroll\", updateScrollYProgress);\r\n  window.removeEventListener(\"resize\", updateScrollYProgress);\r\n});\r\n\r\nfunction updateSVGHeight() {\r\n  if (!tracingBeamContentRef.value) return;\r\n\r\n  svgHeight.value = tracingBeamContentRef.value.offsetHeight;\r\n}\r\n\r\nfunction mapRange(\r\n  value: number,\r\n  inMin: number,\r\n  inMax: number,\r\n  outMin: number,\r\n  outMax: number,\r\n): number {\r\n  return ((value - inMin) * (outMax - outMin)) / (inMax - inMin) + outMin;\r\n}\r\n</script>\r\n"
    }
  ],
  "fileCount": 2,
  "contentHash": "24ee105d2713af163e94d167170b460079189612"
}
