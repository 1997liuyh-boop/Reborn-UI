{
  "name": "images-slider",
  "dependencies": [
    "@vueuse/core"
  ],
  "files": [
    {
      "path": "ImagesSlider.vue",
      "content": "<template>\r\n  <div\r\n    ref=\"sliderRef\"\r\n    tabindex=\"0\"\r\n    class=\"relative flex size-full items-center justify-center overflow-hidden transition-colors focus:outline-none focus:ring-1\"\r\n    :style=\"{\r\n      perspective: props.perspective,\r\n    }\"\r\n  >\r\n    <Transition\r\n      mode=\"out-in\"\r\n      v-bind=\"transitionProps\"\r\n    >\r\n      <div\r\n        :key=\"currentImage\"\r\n        class=\"\"\r\n      >\r\n        <img\r\n          :src=\"currentImage\"\r\n          :class=\"props.imageClass\"\r\n        />\r\n      </div>\r\n    </Transition>\r\n    <div\r\n      v-if=\"hideOverlay !== true\"\r\n      :class=\"cn('absolute inset-0', props.overlayClass)\"\r\n    >\r\n      <Transition\r\n        appear\r\n        enter-active-class=\"transition-all duration-300 delay-300 ease-in-out\"\r\n        enter-from-class=\"opacity-0 -translate-y-10\"\r\n      >\r\n        <slot\r\n          v-if=\"!isLoading\"\r\n          :current-index=\"currentIndex\"\r\n        ></slot>\r\n      </Transition>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { useIntervalFn, onKeyStroke, useSwipe } from \"@vueuse/core\";\r\nimport { ref, watch, computed, type PropType, type Ref } from \"vue\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nconst props = defineProps({\r\n  images: {\r\n    type: Array as PropType<string[]>,\r\n    default: () => [],\r\n  },\r\n  hideOverlay: {\r\n    type: Boolean,\r\n    default: false,\r\n  },\r\n  overlayClass: {\r\n    type: String,\r\n    default: \"\",\r\n  },\r\n  imageClass: {\r\n    type: String,\r\n    default: \"bg-cover bg-center bg-no-repeat\",\r\n  },\r\n  enterFromClass: {\r\n    type: String,\r\n    default: \"scale-0 origin-center\",\r\n  },\r\n  enterActiveClass: {\r\n    type: String,\r\n    default: \"transition-transform duration-300 ease-in-out\",\r\n  },\r\n  leaveActiveClass: {\r\n    type: String,\r\n    default: \"transition-transform duration-300 ease-in-out\",\r\n  },\r\n  autoplay: {\r\n    type: [Boolean, Number, String],\r\n    default: false,\r\n  },\r\n  direction: {\r\n    type: String,\r\n    default: \"vertical\",\r\n    validator: (v: string) => [\"vertical\", \"horizontal\"].includes(v),\r\n  },\r\n  perspective: {\r\n    type: String,\r\n    default: \"1000px\",\r\n  },\r\n});\r\n\r\nconst sliderRef = ref(null);\r\nconst currentDirection = ref(\"up\");\r\nconst currentIndex = defineModel(\"modelValue\", {\r\n  type: Number,\r\n  default: 0,\r\n});\r\n\r\nfunction setCurrentDirection(dir: \"prev\" | \"next\") {\r\n  if (props.direction === \"horizontal\") {\r\n    currentDirection.value = dir === \"next\" ? \"left\" : \"right\";\r\n  } else {\r\n    currentDirection.value = dir === \"next\" ? \"up\" : \"down\";\r\n  }\r\n}\r\n\r\n// Image Loading\r\nconst isLoading = ref(true);\r\nconst isTransitioning = ref(false);\r\nconst loadedImages: Ref<string[]> = ref([]);\r\nconst currentImage = computed(() => loadedImages.value[currentIndex.value]);\r\n\r\nfunction loadImages() {\r\n  isLoading.value = true;\r\n  const promises = props.images.map(\r\n    (imageSrc): Promise<string> =>\r\n      new Promise((resolve, reject) => {\r\n        const image = new Image();\r\n        image.src = imageSrc;\r\n        image.onload = () => resolve(imageSrc);\r\n        image.onerror = () => reject(imageSrc);\r\n      }),\r\n  );\r\n  Promise.all(promises).then((resolvedImages) => {\r\n    loadedImages.value = resolvedImages;\r\n    isLoading.value = false;\r\n  });\r\n}\r\nloadImages();\r\n\r\n// Navigation\r\n\r\nfunction onPrev() {\r\n  if (isLoading.value || isTransitioning.value) {\r\n    return false;\r\n  }\r\n  setCurrentDirection(\"prev\");\r\n  let target = currentIndex.value - 1;\r\n  if (target < 0) {\r\n    target = loadedImages.value.length - 1;\r\n  }\r\n  currentIndex.value = target;\r\n}\r\n\r\nfunction onNext() {\r\n  if (isLoading.value || isTransitioning.value) {\r\n    return false;\r\n  }\r\n  setCurrentDirection(\"next\");\r\n  let target = currentIndex.value + 1;\r\n  if (target >= loadedImages.value?.length - 1) {\r\n    target = 0;\r\n  }\r\n  currentIndex.value = target;\r\n}\r\n\r\nonKeyStroke(\r\n  [\"ArrowUp\", \"ArrowDown\", \"ArrowLeft\", \"ArrowRight\"],\r\n  (ev) => {\r\n    ev.preventDefault();\r\n    if (isLoading.value || isTransitioning.value) {\r\n      return false;\r\n    }\r\n    pause();\r\n    if ([\"ArrowUp\", \"ArrowLeft\"].includes(ev.key)) {\r\n      onPrev();\r\n    } else {\r\n      onNext();\r\n    }\r\n  },\r\n  {\r\n    target: sliderRef,\r\n  },\r\n);\r\n\r\nconst { direction: swipingDirection, isSwiping } = useSwipe(sliderRef, {\r\n  passive: false,\r\n});\r\nwatch(swipingDirection, (dir) => {\r\n  switch (dir) {\r\n    case \"up\":\r\n    case \"left\":\r\n      return onPrev();\r\n    case \"down\":\r\n    case \"right\":\r\n      return onNext();\r\n  }\r\n});\r\n\r\nwatch(isSwiping, setSwiping);\r\n\r\nfunction setSwiping(v: boolean) {\r\n  if (v) {\r\n    pause();\r\n    return;\r\n  }\r\n\r\n  resume();\r\n}\r\n\r\n// Autoplay\r\nconst autoplayInterval = computed(() => {\r\n  if (props.autoplay === false) return 0;\r\n  else if (props.autoplay === true) return 5000;\r\n  else if (typeof props.autoplay === \"string\") {\r\n    return +props.autoplay;\r\n  } else return props.autoplay;\r\n});\r\n\r\nconst { pause, resume, isActive } = useIntervalFn(() => {\r\n  onNext();\r\n}, autoplayInterval);\r\n\r\nwatch(isLoading, (v) => {\r\n  if (v) pause();\r\n  else resume();\r\n});\r\n\r\n// Transitions\r\nfunction lockViewport() {\r\n  isTransitioning.value = true;\r\n}\r\n\r\nfunction unlockViewport() {\r\n  isTransitioning.value = false;\r\n  if (isActive.value === false && autoplayInterval.value) {\r\n    resume();\r\n  }\r\n}\r\nconst transitionProps = computed(() => {\r\n  const bind = {\r\n    enterActiveClass: props.enterActiveClass,\r\n    leaveActiveClass: props.leaveActiveClass,\r\n    enterFromClass: props.enterFromClass,\r\n    leaveToClass: \"\",\r\n    onBeforeLeave: lockViewport,\r\n    onAfterEnter: unlockViewport,\r\n  };\r\n\r\n  switch (currentDirection.value) {\r\n    case \"up\":\r\n      bind.leaveToClass = \"-translate-y-full\";\r\n      break;\r\n    case \"down\":\r\n      bind.leaveToClass = \"translate-y-full\";\r\n      break;\r\n    case \"left\":\r\n      bind.leaveToClass = \"-translate-x-full\";\r\n      break;\r\n    case \"right\":\r\n      bind.leaveToClass = \"translate-x-full\";\r\n      break;\r\n  }\r\n\r\n  return bind;\r\n});\r\n</script>\r\n"
    },
    {
      "path": "index.ts",
      "content": "export { default as ImagesSlider } from \"./ImagesSlider.vue\";\r\n"
    }
  ],
  "fileCount": 2,
  "contentHash": "2a6ead55b26628bfab5356a52b226c18b250984c"
}
