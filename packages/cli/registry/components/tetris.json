{
  "name": "tetris",
  "dependencies": [
    "@vueuse/core",
    "theme-colors"
  ],
  "files": [
    {
      "path": "index.ts",
      "content": "export { default as Tetris } from \"./Tetris.vue\";\r\n"
    },
    {
      "path": "Tetris.vue",
      "content": "<template>\r\n  <Transition\r\n    appear\r\n    name=\"fade\"\r\n  >\r\n    <div\r\n      :style=\"{\r\n        '--cell-size': `${width / cols}px`,\r\n        '--grid-rows': rows - 1,\r\n      }\"\r\n      :class=\"cn('relative w-full', props.class)\"\r\n    >\r\n      <div\r\n        ref=\"el\"\r\n        class=\"absolute inset-0 grid justify-center -space-y-px\"\r\n        :style=\"{ gridTemplateRows: `repeat(var(--grid-rows), var(--cell-size))` }\"\r\n      >\r\n        <div\r\n          v-for=\"(row, rowIndex) in grid\"\r\n          :key=\"rowIndex\"\r\n          class=\"grid flex-1 grid-flow-col -space-x-px\"\r\n          :style=\"{ gridTemplateColumns: `repeat(${cols}, var(--cell-size))` }\"\r\n        >\r\n          <div\r\n            v-for=\"(cell, cellIndex) in row\"\r\n            :key=\"cellIndex\"\r\n            :style=\"{\r\n              '--border-light': theme[100],\r\n              '--border-dark': theme[900],\r\n              '--square-light': theme[500],\r\n              '--square-hover-light': theme[400],\r\n              '--square-dark': theme[700],\r\n              '--square-hover-dark': theme[600],\r\n            }\"\r\n            class=\"relative border border-[color:var(--border-light)] dark:border-[color:var(--border-dark)]\"\r\n          >\r\n            <div\r\n              class=\"absolute inset-0 bg-[color:var(--square-light)] opacity-0 transition-opacity duration-1000 will-change-[opacity] hover:bg-[color:var(--square-hover-light)] dark:bg-[color:var(--square-dark)] dark:hover:bg-[color:var(--square-hover-dark)]\"\r\n              :class=\"[cell && 'cursor-pointer opacity-60']\"\r\n              @click=\"cell && removeCell(rowIndex, cellIndex)\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </Transition>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { useElementSize } from \"@vueuse/core\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { getColors } from \"theme-colors\";\r\nimport { ref, onMounted, onUnmounted, watch } from \"vue\";\r\n\r\ninterface Props {\r\n  class?: string;\r\n  squareColor: string;\r\n  base?: number;\r\n}\r\n\r\nconst props = withDefaults(defineProps<Props>(), {\r\n  base: 10,\r\n});\r\n\r\nconst theme = getColors(props.squareColor);\r\n\r\nconst el = ref(null);\r\nconst grid = ref<(boolean | null)[][]>([]);\r\nconst rows = ref(0);\r\nconst cols = ref(0);\r\n\r\nconst { width, height } = useElementSize(el);\r\n\r\nfunction createGrid() {\r\n  grid.value = [];\r\n\r\n  for (let i = 0; i < rows.value; i++) {\r\n    grid.value.push(new Array(cols.value).fill(null));\r\n  }\r\n}\r\n\r\nfunction createNewCell() {\r\n  const x = Math.floor(Math.random() * cols.value);\r\n\r\n  grid.value[0][x] = true;\r\n}\r\n\r\nfunction moveCellsDown() {\r\n  for (let row = rows.value - 1; row >= 0; row--) {\r\n    for (let col = 0; col < cols.value; col++) {\r\n      const cell = grid.value[row][col];\r\n      const nextCell = Array.isArray(grid.value[row + 1]) ? grid.value[row + 1][col] : cell;\r\n      if (cell !== null && nextCell === null) {\r\n        grid.value[row + 1][col] = grid.value[row][col];\r\n        grid.value[row][col] = null;\r\n      }\r\n    }\r\n  }\r\n\r\n  setTimeout(() => {\r\n    const isFilled = grid.value[rows.value - 1].every((cell) => cell !== null);\r\n    if (Array.isArray(grid.value[rows.value]) && isFilled) {\r\n      for (let col = 0; col < cols.value; col++) {\r\n        grid.value[rows.value][col] = null;\r\n      }\r\n    }\r\n  }, 500);\r\n}\r\n\r\nfunction clearColumn() {\r\n  const isFilled = grid.value[rows.value - 1].every((cell) => cell === true);\r\n  if (!isFilled) return;\r\n\r\n  for (let col = 0; col < cols.value; col++) {\r\n    grid.value[rows.value - 1][col] = null;\r\n  }\r\n}\r\n\r\nfunction removeCell(row: number, col: number) {\r\n  grid.value[row][col] = null;\r\n}\r\n\r\nfunction calcGrid() {\r\n  const cell = width.value / props.base;\r\n\r\n  rows.value = Math.floor(height.value / cell);\r\n  cols.value = Math.floor(width.value / cell);\r\n\r\n  createGrid();\r\n}\r\n\r\nwatch(width, calcGrid);\r\n\r\n// eslint-disable-next-line no-undef\r\nlet intervalId: NodeJS.Timeout | undefined;\r\n// eslint-disable-next-line no-undef\r\nlet timeoutId: NodeJS.Timeout | undefined;\r\n\r\nonMounted(() => {\r\n  timeoutId = setTimeout(calcGrid, 50);\r\n\r\n  intervalId = setInterval(() => {\r\n    clearColumn();\r\n    moveCellsDown();\r\n    createNewCell();\r\n  }, 1000);\r\n});\r\n\r\nonUnmounted(() => {\r\n  clearInterval(intervalId);\r\n  clearTimeout(timeoutId);\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.fade-enter-active,\r\n.fade-leave-active {\r\n  transition: opacity 0.5s ease;\r\n}\r\n\r\n.fade-enter-from,\r\n.fade-leave-to {\r\n  opacity: 0;\r\n}\r\n</style>\r\n",
      "target": "web"
    },
    {
      "path": "Tetris.vue",
      "content": "<template>\r\n  <Transition\r\n    appear\r\n    name=\"fade\"\r\n  >\r\n    <view\r\n      :style=\"{\r\n        '--cell-size': `${width / cols}px`,\r\n        '--grid-rows': rows - 1,\r\n      }\"\r\n      :class=\"cn('relative w-full', props.class)\"\r\n    >\r\n      <view\r\n        ref=\"el\"\r\n        class=\"absolute inset-0 grid justify-center -space-y-px\"\r\n        :style=\"{ gridTemplateRows: `repeat(var(--grid-rows), var(--cell-size))` }\"\r\n      >\r\n        <view\r\n          v-for=\"(row, rowIndex) in grid\"\r\n          :key=\"rowIndex\"\r\n          class=\"grid flex-1 grid-flow-col -space-x-px\"\r\n          :style=\"{ gridTemplateColumns: `repeat(${cols}, var(--cell-size))` }\"\r\n        >\r\n          <view\r\n            v-for=\"(cell, cellIndex) in row\"\r\n            :key=\"cellIndex\"\r\n            :style=\"{\r\n              '--border-light': theme[100],\r\n              '--border-dark': theme[900],\r\n              '--square-light': theme[500],\r\n              '--square-hover-light': theme[400],\r\n              '--square-dark': theme[700],\r\n              '--square-hover-dark': theme[600],\r\n            }\"\r\n            class=\"relative border border-[color:var(--border-light)] dark:border-[color:var(--border-dark)]\"\r\n          >\r\n            <view\r\n              class=\"absolute inset-0 bg-[color:var(--square-light)] opacity-0 transition-opacity duration-1000 will-change-[opacity] hover:bg-[color:var(--square-hover-light)] dark:bg-[color:var(--square-dark)] dark:hover:bg-[color:var(--square-hover-dark)]\"\r\n              :class=\"[cell && 'cursor-pointer opacity-60']\"\r\n              @click=\"cell && removeCell(rowIndex, cellIndex)\"\r\n            />\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n  </Transition>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { useElementSize } from \"@vueuse/core\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { getColors } from \"theme-colors\";\r\nimport { ref, onMounted, onUnmounted, watch } from \"vue\";\r\n\r\ninterface Props {\r\n  class?: string;\r\n  squareColor: string;\r\n  base?: number;\r\n}\r\n\r\nconst props = withDefaults(defineProps<Props>(), {\r\n  base: 10,\r\n});\r\n\r\nconst theme = getColors(props.squareColor);\r\n\r\nconst el = ref(null);\r\nconst grid = ref<(boolean | null)[][]>([]);\r\nconst rows = ref(0);\r\nconst cols = ref(0);\r\n\r\nconst { width, height } = useElementSize(el);\r\n\r\nfunction createGrid() {\r\n  grid.value = [];\r\n\r\n  for (let i = 0; i < rows.value; i++) {\r\n    grid.value.push(new Array(cols.value).fill(null));\r\n  }\r\n}\r\n\r\nfunction createNewCell() {\r\n  const x = Math.floor(Math.random() * cols.value);\r\n\r\n  grid.value[0][x] = true;\r\n}\r\n\r\nfunction moveCellsDown() {\r\n  for (let row = rows.value - 1; row >= 0; row--) {\r\n    for (let col = 0; col < cols.value; col++) {\r\n      const cell = grid.value[row][col];\r\n      const nextCell = Array.isArray(grid.value[row + 1]) ? grid.value[row + 1][col] : cell;\r\n      if (cell !== null && nextCell === null) {\r\n        grid.value[row + 1][col] = grid.value[row][col];\r\n        grid.value[row][col] = null;\r\n      }\r\n    }\r\n  }\r\n\r\n  setTimeout(() => {\r\n    const isFilled = grid.value[rows.value - 1].every((cell) => cell !== null);\r\n    if (Array.isArray(grid.value[rows.value]) && isFilled) {\r\n      for (let col = 0; col < cols.value; col++) {\r\n        grid.value[rows.value][col] = null;\r\n      }\r\n    }\r\n  }, 500);\r\n}\r\n\r\nfunction clearColumn() {\r\n  const isFilled = grid.value[rows.value - 1].every((cell) => cell === true);\r\n  if (!isFilled) return;\r\n\r\n  for (let col = 0; col < cols.value; col++) {\r\n    grid.value[rows.value - 1][col] = null;\r\n  }\r\n}\r\n\r\nfunction removeCell(row: number, col: number) {\r\n  grid.value[row][col] = null;\r\n}\r\n\r\nfunction calcGrid() {\r\n  const cell = width.value / props.base;\r\n\r\n  rows.value = Math.floor(height.value / cell);\r\n  cols.value = Math.floor(width.value / cell);\r\n\r\n  createGrid();\r\n}\r\n\r\nwatch(width, calcGrid);\r\n\r\n// eslint-disable-next-line no-undef\r\nlet intervalId: NodeJS.Timeout | undefined;\r\n// eslint-disable-next-line no-undef\r\nlet timeoutId: NodeJS.Timeout | undefined;\r\n\r\nonMounted(() => {\r\n  timeoutId = setTimeout(calcGrid, 50);\r\n\r\n  intervalId = setInterval(() => {\r\n    clearColumn();\r\n    moveCellsDown();\r\n    createNewCell();\r\n  }, 1000);\r\n});\r\n\r\nonUnmounted(() => {\r\n  clearInterval(intervalId);\r\n  clearTimeout(timeoutId);\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.fade-enter-active,\r\n.fade-leave-active {\r\n  transition: opacity 0.5s ease;\r\n}\r\n\r\n.fade-enter-from,\r\n.fade-leave-to {\r\n  opacity: 0;\r\n}\r\n</style>\r\n",
      "target": "uniapp"
    }
  ],
  "fileCount": 3,
  "contentHash": "3fb75a4ef2e7dbd728dc3b11d114461fca3f7db4"
}
