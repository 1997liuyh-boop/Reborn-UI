{
  "name": "globe",
  "dependencies": [
    "cobe",
    "vue-use-spring"
  ],
  "files": [
    {
      "path": "Globe.vue",
      "content": "<template>\r\n  <div :class=\"cn('absolute inset-0 mx-auto aspect-[1/1] w-full max-w-[600px]', $props.class)\">\r\n    <canvas\r\n      ref=\"globeCanvasRef\"\r\n      class=\"size-full opacity-0 transition-opacity duration-1000 ease-in-out [contain:layout_paint_size]\"\r\n      @pointerdown=\"(e) => updatePointerInteraction(e.clientX)\"\r\n      @pointerup=\"updatePointerInteraction(null)\"\r\n      @pointerout=\"updatePointerInteraction(null)\"\r\n      @mousemove=\"(e) => updateMovement(e.clientX)\"\r\n      @touchmove=\"(e) => e.touches[0] && updateMovement(e.touches[0].clientX)\"\r\n    ></canvas>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport { cn } from \"@/lib/utils\";\r\nimport createGlobe, { type COBEOptions } from \"cobe\";\r\nimport { useSpring } from \"vue-use-spring\";\r\nimport { ref, onMounted, onBeforeUnmount } from \"vue\";\r\n\r\ntype GlobeProps = {\r\n  class?: string;\r\n  config?: Partial<COBEOptions>;\r\n  mass?: number;\r\n  tension?: number;\r\n  friction?: number;\r\n  precision?: number;\r\n};\r\n\r\nconst DEFAULT_CONFIG: COBEOptions = {\r\n  width: 800,\r\n  height: 800,\r\n  onRender: () => {},\r\n  devicePixelRatio: 2,\r\n  phi: 0,\r\n  theta: 0.3,\r\n  dark: 0,\r\n  diffuse: 0.4,\r\n  mapSamples: 16000,\r\n  mapBrightness: 1.2,\r\n  baseColor: [1, 1, 1],\r\n  markerColor: [251 / 255, 100 / 255, 21 / 255],\r\n  glowColor: [1.2, 1.2, 1.2],\r\n  markers: [\r\n    { location: [14.5995, 120.9842], size: 0.03 },\r\n    { location: [19.076, 72.8777], size: 0.1 },\r\n    { location: [23.8103, 90.4125], size: 0.05 },\r\n    { location: [30.0444, 31.2357], size: 0.07 },\r\n    { location: [39.9042, 116.4074], size: 0.08 },\r\n    { location: [-23.5505, -46.6333], size: 0.1 },\r\n    { location: [19.4326, -99.1332], size: 0.1 },\r\n    { location: [40.7128, -74.006], size: 0.1 },\r\n    { location: [34.6937, 135.5022], size: 0.05 },\r\n    { location: [41.0082, 28.9784], size: 0.06 },\r\n  ],\r\n};\r\n\r\nconst props = withDefaults(defineProps<GlobeProps>(), {\r\n  mass: 1,\r\n  tension: 280,\r\n  friction: 100,\r\n  precision: 0.001,\r\n});\r\n\r\nconst globeCanvasRef = ref<HTMLCanvasElement>();\r\nconst phi = ref(0);\r\nconst width = ref(0);\r\nconst pointerInteracting = ref();\r\nconst pointerInteractionMovement = ref();\r\n\r\nlet globe: ReturnType<typeof createGlobe> | null = null;\r\n\r\nconst spring = useSpring(\r\n  {\r\n    r: 0,\r\n  },\r\n  {\r\n    mass: props.mass,\r\n    tension: props.tension,\r\n    friction: props.friction,\r\n    precision: props.precision,\r\n  },\r\n);\r\n\r\nfunction updatePointerInteraction(clientX: number | null) {\r\n  if (clientX !== null) {\r\n    pointerInteracting.value = clientX - (pointerInteractionMovement.value ?? clientX);\r\n  } else {\r\n    pointerInteracting.value = null;\r\n  }\r\n\r\n  if (globeCanvasRef.value) {\r\n    globeCanvasRef.value.style.cursor = clientX ? \"grabbing\" : \"grab\";\r\n  }\r\n}\r\n\r\nfunction updateMovement(clientX: number) {\r\n  if (pointerInteracting.value !== null) {\r\n    const delta = clientX - (pointerInteracting.value ?? clientX);\r\n    pointerInteractionMovement.value = delta;\r\n    spring.r = delta / 200;\r\n  }\r\n}\r\n\r\nfunction onRender(state: Record<string, unknown>) {\r\n  if (!pointerInteracting.value) {\r\n    phi.value += 0.005;\r\n  }\r\n\r\n  state.phi = phi.value + spring.r;\r\n  state.width = width.value * 2;\r\n  state.height = width.value * 2;\r\n}\r\n\r\nfunction onResize() {\r\n  if (globeCanvasRef.value) {\r\n    width.value = globeCanvasRef.value.offsetWidth;\r\n  }\r\n}\r\n\r\nfunction createGlobeOnMounted() {\r\n  const config = { ...DEFAULT_CONFIG, ...props.config };\r\n\r\n  globe = createGlobe(globeCanvasRef.value!, {\r\n    ...config,\r\n    width: width.value * 2,\r\n    height: width.value * 2,\r\n    onRender,\r\n  });\r\n}\r\n\r\nonMounted(() => {\r\n  window.addEventListener(\"resize\", onResize);\r\n  onResize();\r\n  createGlobeOnMounted();\r\n\r\n  setTimeout(() => (globeCanvasRef.value!.style.opacity = \"1\"));\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  globe?.destroy();\r\n  window.removeEventListener(\"resize\", onResize);\r\n});\r\n</script>\r\n"
    },
    {
      "path": "index.ts",
      "content": "export { default as Globe } from \"./Globe.vue\";\r\n"
    }
  ],
  "fileCount": 2,
  "contentHash": "3b87bf2da7dd6e410f9d0b4852858f6bbaac98bf"
}
